<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Buscador de Compañías</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <h1>Buscador de Compañías</h1>
    <form method="POST">
        <input type="text" name="search" placeholder="Buscar por nombre...">
        <input type="submit" value="Buscar">
    </form>

    {% if results %}
        <h2>Resultados:</h2>
        <ul>
            {% for compania, ranking in results %}
                <li>ID: {{ compania.expediente }} - Nombre: {{ compania.nombre }} - Expediente: {{ ranking.expediente }} - Utilidad: {{ ranking.utilidad_ejercicio }} - Año: {{ ranking.anio }}</li>
            {% endfor %}
        </ul>

        <!-- Gráfico de dispersión -->
        <canvas id="scatterChart" width="400" height="200"></canvas>
        <script>
            const ctx = document.getElementById('scatterChart').getContext('2d');
            const data = {
                datasets: [{
                    label: 'Utilidad por Año',
                    data: [
                        {% for util, anio in data %}
                        { x: {{ anio }}, y: {{ util }} },
                        {% endfor %}
                    ],
                    backgroundColor: 'rgba(75, 192, 192, 1)',
                }]
            };

            const config = {
                type: 'scatter',
                data: data,
                options: {
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'Año'
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'Utilidad'
                            }
                        }
                    }
                }
            };

            const scatterChart = new Chart(ctx, config);
        </script>
    {% else %}
        <p>No se encontraron resultados.</p>
    {% endif %}
</body>
</html>
